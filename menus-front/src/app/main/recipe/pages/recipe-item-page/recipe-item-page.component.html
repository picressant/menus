<mat-tab-group>
  <mat-tab label="Détails">
    <div class="file-input-wrapper">
      <div class="picture c-hand" (click)="file.click()">
        <img [src]="imgPreviewURL" alt="Profile" height="200" width="200" *ngIf="imgPreviewURL">
        <menus-loading-img
          [styles]="imgStyles"
          [src]="'recipe/' + id + '/picture?' + timestamp | secure | async"
          *ngIf="!imgPreviewURL"></menus-loading-img>
        <mat-icon class="upload-icon" *ngIf="!isReadonly">cloud_upload</mat-icon>
      </div>
      <input type="file" #file (change)="preview(file.files)" [disabled]="this.form.disabled">
    </div>
    <div [formGroup]="form" class="form-wrapper">
      <menus-form-field-wrapper
        dataError="Obligatoire"
        label="Nom de la recette"
        type="text"
        [control]="form.controls.name"></menus-form-field-wrapper>

      <menus-form-field-wrapper
        dataError="Obligatoire"
        label="Temps de préparation"
        type="number"
        [control]="form.controls.preparationTime"></menus-form-field-wrapper>

      <menus-form-field-wrapper
        dataError="Obligatoire"
        label="Temps de cuisson"
        type="number"
        [control]="form.controls.cookingTime"></menus-form-field-wrapper>

      <menus-form-field-wrapper
        dataError="Obligatoire"
        label="Temps de personnes"
        type="number"
        [control]="form.controls.persons"></menus-form-field-wrapper>

      <menus-form-field-wrapper
        label="Livre de recette"
        type="text"
        [control]="form.controls.bookReference"></menus-form-field-wrapper>
    </div>

  </mat-tab>
  <mat-tab label="Ingrédients">
    <div class="table-wrapper">
      <button mat-raised-button color="primary" class="add-button" (click)="addIngredient()" [disabled]="isReadonly">
        <mat-icon>add</mat-icon>
        <span class="responsive hide">Ajouter</span>
      </button>
      <table mat-table [dataSource]="dataSource">

        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef> Nom</th>
          <td mat-cell *matCellDef="let ingredientQuantity"> {{ingredientQuantity.ingredient.name}} </td>
        </ng-container>

        <!-- Weight Column -->
        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef> Quantité</th>
          <td mat-cell *matCellDef="let ingredientQuantity"> {{ingredientQuantity.quantity}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="unit">
          <th mat-header-cell *matHeaderCellDef> Unité</th>
          <td mat-cell *matCellDef="let ingredientQuantity"> {{ingredientQuantity.ingredient.unit.symbol}} </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let ingredientQuantity; let i = index">
            <div class="table-button-wrapper">
              <button mat-icon-button color="primary" (click)="onEditIngredient(ingredientQuantity, i)"
                      [disabled]="isReadonly">
                <mat-icon>create</mat-icon>
              </button>
              <button mat-icon-button color="warn" (click)="onDeleteIngredient(ingredientQuantity)"
                      [disabled]="isReadonly">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>


        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>
  </mat-tab>
</mat-tab-group>
<div class="submit-form">
  <button mat-raised-button color="warn" class="submit-button" type="button" (click)="cancel()" *ngIf="!isReadonly">
    Annuler
  </button>
  <button mat-raised-button color="primary" class="submit-button" type="button" (click)="submit()"
          [disabled]="form.invalid" *ngIf="!isReadonly">
    Sauvegarder
  </button>
  <button mat-raised-button color="primary" class="submit-button" type="button" (click)="modify()" *ngIf="isReadonly">
    Modifier
  </button>
</div>
